
--v0.2 Final Script

--use EclipseBronze
WITH
CTE_Stage as (
SELECT 
ProgramRef,LayerNum,StatsCcyROE,CONVERT(smalldatetime,AnnivDate,104) as AnnivDate,DaysNotice,UW,Interest,PolicyId,PolicyRef,EntryType,DecRef,LloydsBrokerId,LloydsBrokerRef,LloydsBrokerContactId,BucketInd,PeriodType,CONVERT(smalldatetime,InceptionDate,104) as InceptionDate,CONVERT(smalldatetime,ExpiryDate,104) as ExpiryDate,TermsOfTrade,CONVERT(smalldatetime,DateWritten,104) as DateWritten,CONVERT(smalldatetime,FirstWritten,104) as FirstWritten,ClaimInd,Brokerage,Deductions,CONVERT(smalldatetime,CancelDate,104) as CancelDate,StatsCcyISO,ConsCcyISO,ConsTotalSyndEPI,ConsTotalSyndExposure,Notes,RenewedFromRef,RenewedToRef,GrossPremIncome,Comm,CommMisc,CoverType,UniqueMarketRef,PlacingType,WordingStatus,PortfolioTransInd,LossOfUseDaily,CONVERT(smalldatetime,LastUpd,104) as LastUpd,SectionCode,Period,FullTermPeriod,CONVERT(smalldatetime,FullTermInceptionDate,104) as FullTermInceptionDate,CONVERT(smalldatetime,FullTermExpiryDate,104) as FullTermExpiryDate,FullTermResignInd,ProfitComm,ProfitComm2,CommDeductionsInd,ProfitCommExpense,OtherDeductions,PremFreq,CONVERT(smalldatetime,FirstSettDueDate,104) as FirstSettDueDate,SettTermOfTrade,AdjTermsOfTrade,CoverMaxPeriod,CommSlideAt,BordereauPremTermsOfTrade,TreatyReinsInd,CoIns,SysLastUpd,NoClaimBonus,EarnPattern,LossOfUseLimit,LossOfUseXs,LossOfUseExposure,LossOfUseCcyISO,LossOfUseXsDsc,CommSlide,CommSlideProv,CommSlideLR,CommSlideMin,BordereauClaimTermsOfTrade,WaitPeriod,SmokerInd,BordereauClaimFreq,Sex,CONVERT(smalldatetime,DateOfBirth,104) as DateOfBirth,QuotaSharePct,BordereauPremFreq,QuotaShareLine,ConvertedInd,IPTPct,IPTPremApplic,RepGroup,SysPolicyType,TotalSyndEPI,TotalSyndExposure,UWDivision,WriteBackPct,LloydsBrokerCode,LloydsBrokerPseud,YOA,PerilGroupId,TerritoryId,TopLimit,TopLimitCcyISO,TopXs
,LossOfUseDays,CONVERT(smalldatetime,InsDate,104) as InsDate,CONVERT(smalldatetime,DelDate,104) as DelDate,OtherDeductionsApplyInd,ProfitCommApplyInd,PolicyType,BenefitsType,NoOfLives,Grantee,CONVERT(datetime,ProfitCommAdj,127) as ProfitCommAdj,PolicyStatus,ParentPolicyId,CancBasis,RemindFreq,CONVERT(datetime,RemindDate,127) as RemindDate,RemindMess,RemindEmail,TerritoryIdAssured,BestCode,NAICCode,Producer,Class1,Class2,Class3,GeogCode,TotalSumInsured,CalcFromWritten,BrokerageDeductionsInd,MaxLimit,MinXS,RateFixedInd,TopLimitOrigCcyISO,TopLimitOrigAmount,TopLimitSettAmount,TopLimitConsAmount,TopXSOrigAmount,TopXSSettAmount,TopXSConsAmount,ConsCcyROE,TopLimitSettCcyISO,FILCode,UserName,AggLimit,PaymentMethod,PaymentType,AdjFreq,AdjPcnt,AdjDsc,CONVERT(datetime,AdjDate,127) as AdjDate,CONVERT(datetime,DWAgreed,127) as DWAgreed,ClaimFundInd,NeedReCalcInd,ProfitCommAgreed,Class4,FrontingInd,FinanceUWInd,NOCInd,FullTermInd,EndorsemntInd,FacReinsInd,MonitorPIMInd,CONVERT(smalldatetime,DateEntered,104) as DateEntered,UpdBy,MainLayerInd,QuoteDurationDays,UltimateLossRatio,AccountsPayable,BenchMarkRating,InstalmentPeriod,InitialTOT,DeferredTOT,FinalTOT,ConfidentialNotes,LOCInd,CONVERT(smalldatetime,ReviewDate,104) as ReviewDate,EventName,EventMultiple,OutdoorEventInd,LTPInd,TerrorMiles,TerrorDays,ZipCode,SurveyFees,VetsFees,ConsultancyFees,ExpertFees,AnticipatedLR,PremWarrantyInd,CONVERT(smalldatetime,WordingDate,104) as WordingDate,WordingNote,NettLineInd,ReinstBrokerage,LossWarrantyTriggers,LossReviewPct,WarInd,StrikesInd,ExpensesInd,SurveyInd,CONVERT(smalldatetime,SurveyDate,104) as SurveyDate,NumOfInstalment
,CONVERT(smalldatetime,SettDueDate,104) as SettDueDate,CONVERT(datetime,QuoteExpiryDate,127) as QuoteExpiryDate,CONVERT(datetime,QuoteInceptionDate,127) as QuoteInceptionDate,BureauSettledInd,VenueCity,LORSCode,NoticeToBrokerInsured,CONVERT(smalldatetime,NoticeToBrokerInsuredDate,104) as NoticeToBrokerInsuredDate,AssuredSignOff,CONVERT(smalldatetime,AssuredSignOffDate,104) as AssuredSignOffDate,TerrorismAPCcy,TerrorismAPAmount,TerrorismAPReceived,CONVERT(smalldatetime,TerrorismAPReceivedDate,104) as TerrorismAPReceivedDate,ZoneA,ZoneB,ZoneC,ZoneD,BusinessInterruption,ManyFacInd,EventPeriod,CONVERT(smalldatetime,EventPeriodInception,104) as EventPeriodInception,CONVERT(smalldatetime,EventPeriodExpiry,104) as EventPeriodExpiry,CONVERT(datetime,PremiumSwitchDate,127) as PremiumSwitchDate,PremiumSwitchedInd,CONVERT(smalldatetime,RetroDate,104) as RetroDate,MinimumRate,MaximumRate,LossesLoaded,QuotedROL,CONVERT(datetime,RetroactiveDate,127) as RetroactiveDate,OldStatsRef,Description,ExternalRef,OrigPRI,OrigCI,UpdPRI,UpdCI,PRIInd,ConfiscationInd,OutwardPolicyInd,CONVERT(smalldatetime,PeerReviewDate,104) as PeerReviewDate,PeerReviewInd,ContractCertainty,ContractCertaintyExcpt,CONVERT(smalldatetime,ContractCertaintyDate,104) as ContractCertaintyDate,AggRiskData,ExternalRef2,BUAAInd,PRILossRatioOrig,PRILossRatioUpd,PRINewOldPremOrig,PRINewOldPremUpd,DeficitClause,TruePrice,AdditionalLines,AnticipatedLossRatio,RiskTransfer,LeadInd,ManualMatchingInd,ProcessingType,Indexed,CONVERT(smalldatetime,CommutedDate,104) as CommutedDate,CONVERT(smalldatetime,CommutationOptDate,104) as CommutationOptDate,VerificationStatus,CashLossLimit,ClaimsAgreement,TradeCode,Market,BrokerSettledInd,ScheduleTypeId,DealReference,ExternalRef_COMP,ExternalRef_ForUniqueConstraint,DecRef_ForUniqueConstraint,MasterPolicy,ExternallyProvidedInd,PartVIIInd,SYS_CHANGE_OPERATION
,HASHBYTES('SHA1',CONVERT(NVARCHAR(MAX),CONCAT(ProgramRef,'%',LayerNum,'%',StatsCcyROE,'%',CONVERT(smalldatetime,AnnivDate,104),'%',DaysNotice,'%',UW,'%',Interest,'%',PolicyId,'%',PolicyRef,'%',EntryType,'%',DecRef,'%',LloydsBrokerId,'%',LloydsBrokerRef,'%',LloydsBrokerContactId,'%',BucketInd,'%',PeriodType,'%',CONVERT(smalldatetime,InceptionDate,104),'%',CONVERT(smalldatetime,ExpiryDate,104),'%',TermsOfTrade,'%',CONVERT(smalldatetime,DateWritten,104),'%',CONVERT(smalldatetime,FirstWritten,104),'%',ClaimInd,'%',Brokerage,'%',Deductions,'%',CONVERT(smalldatetime,CancelDate,104),'%',StatsCcyISO,'%',ConsCcyISO,'%',ConsTotalSyndEPI,'%',ConsTotalSyndExposure,'%',Notes,'%',RenewedFromRef,'%',RenewedToRef,'%',GrossPremIncome,'%',Comm,'%',CommMisc,'%',CoverType,'%',UniqueMarketRef,'%',PlacingType,'%',WordingStatus,'%',PortfolioTransInd,'%',LossOfUseDaily,'%',CONVERT(smalldatetime,LastUpd,104),'%',SectionCode,'%',Period,'%',FullTermPeriod,'%',CONVERT(smalldatetime,FullTermInceptionDate,104),'%',CONVERT(smalldatetime,FullTermExpiryDate,104),'%',FullTermResignInd,'%',ProfitComm,'%',ProfitComm2,'%',CommDeductionsInd,'%',ProfitCommExpense,'%',OtherDeductions,'%',PremFreq,'%',CONVERT(smalldatetime,FirstSettDueDate,104),'%',SettTermOfTrade,'%',AdjTermsOfTrade,'%',CoverMaxPeriod,'%',CommSlideAt,'%',BordereauPremTermsOfTrade,'%',TreatyReinsInd,'%',CoIns,'%',SysLastUpd,'%',NoClaimBonus,'%',EarnPattern,'%',LossOfUseLimit,'%',LossOfUseXs,'%',LossOfUseExposure,'%',LossOfUseCcyISO,'%',LossOfUseXsDsc,'%',CommSlide,'%',CommSlideProv,'%',CommSlideLR,'%',CommSlideMin,'%',BordereauClaimTermsOfTrade,'%',WaitPeriod,'%',SmokerInd,'%',BordereauClaimFreq,'%',Sex,'%',CONVERT(smalldatetime,DateOfBirth,104),'%',QuotaSharePct,'%',BordereauPremFreq,'%',QuotaShareLine,'%',ConvertedInd,'%',IPTPct,'%',IPTPremApplic,'%',RepGroup,'%',SysPolicyType,'%',TotalSyndEPI,'%',TotalSyndExposure,'%',UWDivision,'%',WriteBackPct,'%',LloydsBrokerCode,'%',LloydsBrokerPseud,'%',YOA,'%',PerilGroupId,'%',TerritoryId,'%',TopLimit,'%',TopLimitCcyISO,'%',TopXs))) as HBSTG100
,HASHBYTES('SHA1',CONVERT(NVARCHAR(MAX),CONCAT(LossOfUseDays,'%',CONVERT(smalldatetime,InsDate,104),'%',CONVERT(smalldatetime,DelDate,104),'%',OtherDeductionsApplyInd,'%',ProfitCommApplyInd,'%',PolicyType,'%',BenefitsType,'%',NoOfLives,'%',Grantee,'%',CONVERT(smalldatetime,ProfitCommAdj,127),'%',PolicyStatus,'%',ParentPolicyId,'%',CancBasis,'%',RemindFreq,'%',CONVERT(smalldatetime,RemindDate,127),'%',RemindMess,'%',RemindEmail,'%',TerritoryIdAssured,'%',BestCode,'%',NAICCode,'%',Producer,'%',Class1,'%',Class2,'%',Class3,'%',GeogCode,'%',TotalSumInsured,'%',CalcFromWritten,'%',BrokerageDeductionsInd,'%',MaxLimit,'%',MinXS,'%',RateFixedInd,'%',TopLimitOrigCcyISO,'%',TopLimitOrigAmount,'%',TopLimitSettAmount,'%',TopLimitConsAmount,'%',TopXSOrigAmount,'%',TopXSSettAmount,'%',TopXSConsAmount,'%',ConsCcyROE,'%',TopLimitSettCcyISO,'%',FILCode,'%',UserName,'%',AggLimit,'%',PaymentMethod,'%',PaymentType,'%',AdjFreq,'%',AdjPcnt,'%',AdjDsc,'%',CONVERT(smalldatetime,AdjDate,127),'%',CONVERT(smalldatetime,DWAgreed,127),'%',ClaimFundInd,'%',NeedReCalcInd,'%',ProfitCommAgreed,'%',Class4,'%',FrontingInd,'%',FinanceUWInd,'%',NOCInd,'%',FullTermInd,'%',EndorsemntInd,'%',FacReinsInd,'%',MonitorPIMInd,'%',CONVERT(smalldatetime,DateEntered,104),'%',UpdBy,'%',MainLayerInd,'%',QuoteDurationDays,'%',UltimateLossRatio,'%',AccountsPayable,'%',BenchMarkRating,'%',InstalmentPeriod,'%',InitialTOT,'%',DeferredTOT,'%',FinalTOT,'%',ConfidentialNotes,'%',LOCInd,'%',CONVERT(smalldatetime,ReviewDate,104),'%',EventName,'%',EventMultiple,'%',OutdoorEventInd,'%',LTPInd,'%',TerrorMiles,'%',TerrorDays,'%',ZipCode,'%',SurveyFees,'%',VetsFees,'%',ConsultancyFees,'%',ExpertFees,'%',AnticipatedLR,'%',PremWarrantyInd,'%',CONVERT(smalldatetime,WordingDate,104),'%',WordingNote,'%',NettLineInd,'%',ReinstBrokerage,'%',LossWarrantyTriggers,'%',LossReviewPct,'%',WarInd,'%',StrikesInd,'%',ExpensesInd,'%',SurveyInd,'%',CONVERT(smalldatetime,SurveyDate,104),'%',NumOfInstalment))) as HBSTG200
,HASHBYTES('SHA1',CONVERT(NVARCHAR(MAX),CONCAT(CONVERT(smalldatetime,SettDueDate,104),'%',CONVERT(smalldatetime,QuoteExpiryDate,127),'%',CONVERT(smalldatetime,QuoteInceptionDate,127),'%',BureauSettledInd,'%',VenueCity,'%',LORSCode,'%',NoticeToBrokerInsured,'%',CONVERT(smalldatetime,NoticeToBrokerInsuredDate,104),'%',AssuredSignOff,'%',CONVERT(smalldatetime,AssuredSignOffDate,104),'%',TerrorismAPCcy,'%',TerrorismAPAmount,'%',TerrorismAPReceived,'%',CONVERT(smalldatetime,TerrorismAPReceivedDate,104),'%',ZoneA,'%',ZoneB,'%',ZoneC,'%',ZoneD,'%',BusinessInterruption,'%',ManyFacInd,'%',EventPeriod,'%',CONVERT(smalldatetime,EventPeriodInception,104),'%',CONVERT(smalldatetime,EventPeriodExpiry,104),'%',CONVERT(smalldatetime,PremiumSwitchDate,127),'%',PremiumSwitchedInd,'%',CONVERT(smalldatetime,RetroDate,104),'%',MinimumRate,'%',MaximumRate,'%',LossesLoaded,'%',QuotedROL,'%',CONVERT(smalldatetime,RetroactiveDate,127),'%',OldStatsRef,'%',Description,'%',ExternalRef,'%',OrigPRI,'%',OrigCI,'%',UpdPRI,'%',UpdCI,'%',PRIInd,'%',ConfiscationInd,'%',OutwardPolicyInd,'%',CONVERT(smalldatetime,PeerReviewDate,104),'%',PeerReviewInd,'%',ContractCertainty,'%',ContractCertaintyExcpt,'%',CONVERT(smalldatetime,ContractCertaintyDate,104),'%',AggRiskData,'%',ExternalRef2,'%',BUAAInd,'%',PRILossRatioOrig,'%',PRILossRatioUpd,'%',PRINewOldPremOrig,'%',PRINewOldPremUpd,'%',DeficitClause,'%',TruePrice,'%',AdditionalLines,'%',AnticipatedLossRatio,'%',RiskTransfer,'%',LeadInd,'%',ManualMatchingInd,'%',ProcessingType,'%',Indexed,'%',CONVERT(smalldatetime,CommutedDate,104),'%',CONVERT(smalldatetime,CommutationOptDate,104),'%',VerificationStatus,'%',CashLossLimit,'%',ClaimsAgreement,'%',TradeCode,'%',Market,'%',BrokerSettledInd,'%',ScheduleTypeId,'%',DealReference,'%',ExternalRef_COMP,'%',ExternalRef_ForUniqueConstraint,'%',DecRef_ForUniqueConstraint,'%',MasterPolicy,'%',ExternallyProvidedInd,'%',PartVIIInd,'%',SYS_CHANGE_OPERATION))) as HBSTG300
 FROM OPENROWSET ( 
      BULK 'https://dldpdev01.blob.core.windows.net/bronze/underwriting/Internal/Eclipse/Staging/dbo_Policy/SystemLoadID=1022022101001/**',
      FORMAT = 'parquet'
     ) as RS
	 --WHERE PolicyId = 683602
 )
,CTE_DELTA as (
SELECT 
 [ProgramRef] as [DELTAProgramRef],[LayerNum] as [DELTALayerNum],[StatsCcyROE] as [DELTAStatsCcyROE],[AnnivDate] as [DELTAAnnivDate],[DaysNotice] as [DELTADaysNotice],[UW] as [DELTAUW],[Interest] as [DELTAInterest],[PolicyId] as [DELTAPolicyId],[PolicyRef] as [DELTAPolicyRef],[EntryType] as [DELTAEntryType],[DecRef] as [DELTADecRef],[LloydsBrokerId] as [DELTALloydsBrokerId],[LloydsBrokerRef] as [DELTALloydsBrokerRef],[LloydsBrokerContactId] as [DELTALloydsBrokerContactId],[BucketInd] as [DELTABucketInd],[PeriodType] as [DELTAPeriodType],[InceptionDate] as [DELTAInceptionDate],[ExpiryDate] as [DELTAExpiryDate],[TermsOfTrade] as [DELTATermsOfTrade],[DateWritten] as [DELTADateWritten],[FirstWritten] as [DELTAFirstWritten],[ClaimInd] as [DELTAClaimInd],[Brokerage] as [DELTABrokerage],[Deductions] as [DELTADeductions],[CancelDate] as [DELTACancelDate],[StatsCcyISO] as [DELTAStatsCcyISO],[ConsCcyISO] as [DELTAConsCcyISO],[ConsTotalSyndEPI] as [DELTAConsTotalSyndEPI],[ConsTotalSyndExposure] as [DELTAConsTotalSyndExposure],[Notes] as [DELTANotes],[RenewedFromRef] as [DELTARenewedFromRef],[RenewedToRef] as [DELTARenewedToRef],[GrossPremIncome] as [DELTAGrossPremIncome],[Comm] as [DELTAComm],[CommMisc] as [DELTACommMisc],[CoverType] as [DELTACoverType],[UniqueMarketRef] as [DELTAUniqueMarketRef],[PlacingType] as [DELTAPlacingType],[WordingStatus] as [DELTAWordingStatus],[PortfolioTransInd] as [DELTAPortfolioTransInd],[LossOfUseDaily] as [DELTALossOfUseDaily],[LastUpd] as [DELTALastUpd],[SectionCode] as [DELTASectionCode],[Period] as [DELTAPeriod],[FullTermPeriod] as [DELTAFullTermPeriod],[FullTermInceptionDate] as [DELTAFullTermInceptionDate],[FullTermExpiryDate] as [DELTAFullTermExpiryDate],[FullTermResignInd] as [DELTAFullTermResignInd],[ProfitComm] as [DELTAProfitComm],[ProfitComm2] as [DELTAProfitComm2],[CommDeductionsInd] as [DELTACommDeductionsInd],[ProfitCommExpense] as [DELTAProfitCommExpense],[OtherDeductions] as [DELTAOtherDeductions],[PremFreq] as [DELTAPremFreq],[FirstSettDueDate] as [DELTAFirstSettDueDate],[SettTermOfTrade] as [DELTASettTermOfTrade],[AdjTermsOfTrade] as [DELTAAdjTermsOfTrade],[CoverMaxPeriod] as [DELTACoverMaxPeriod],[CommSlideAt] as [DELTACommSlideAt],[BordereauPremTermsOfTrade] as [DELTABordereauPremTermsOfTrade],[TreatyReinsInd] as [DELTATreatyReinsInd],[CoIns] as [DELTACoIns],[SysLastUpd] as [DELTASysLastUpd],[NoClaimBonus] as [DELTANoClaimBonus],[EarnPattern] as [DELTAEarnPattern],[LossOfUseLimit] as [DELTALossOfUseLimit],[LossOfUseXs] as [DELTALossOfUseXs],[LossOfUseExposure] as [DELTALossOfUseExposure],[LossOfUseCcyISO] as [DELTALossOfUseCcyISO],[LossOfUseXsDsc] as [DELTALossOfUseXsDsc],[CommSlide] as [DELTACommSlide],[CommSlideProv] as [DELTACommSlideProv],[CommSlideLR] as [DELTACommSlideLR],[CommSlideMin] as [DELTACommSlideMin],[BordereauClaimTermsOfTrade] as [DELTABordereauClaimTermsOfTrade],[WaitPeriod] as [DELTAWaitPeriod],[SmokerInd] as [DELTASmokerInd],[BordereauClaimFreq] as [DELTABordereauClaimFreq],[Sex] as [DELTASex],[DateOfBirth] as [DELTADateOfBirth],[QuotaSharePct] as [DELTAQuotaSharePct],[BordereauPremFreq] as [DELTABordereauPremFreq],[QuotaShareLine] as [DELTAQuotaShareLine],[ConvertedInd] as [DELTAConvertedInd],[IPTPct] as [DELTAIPTPct],[IPTPremApplic] as [DELTAIPTPremApplic],[RepGroup] as [DELTARepGroup],[SysPolicyType] as [DELTASysPolicyType],[TotalSyndEPI] as [DELTATotalSyndEPI],[TotalSyndExposure] as [DELTATotalSyndExposure],[UWDivision] as [DELTAUWDivision],[WriteBackPct] as [DELTAWriteBackPct],[LloydsBrokerCode] as [DELTALloydsBrokerCode],[LloydsBrokerPseud] as [DELTALloydsBrokerPseud],[YOA] as [DELTAYOA],[PerilGroupId] as [DELTAPerilGroupId],[TerritoryId] as [DELTATerritoryId],[TopLimit] as [DELTATopLimit],[TopLimitCcyISO] as [DELTATopLimitCcyISO],[TopXs] as [DELTATopXs]
,[LossOfUseDays] as [DELTALossOfUseDays],[InsDate] as [DELTAInsDate],[DelDate] as [DELTADelDate],[OtherDeductionsApplyInd] as [DELTAOtherDeductionsApplyInd],[ProfitCommApplyInd] as [DELTAProfitCommApplyInd],[PolicyType] as [DELTAPolicyType],[BenefitsType] as [DELTABenefitsType],[NoOfLives] as [DELTANoOfLives],[Grantee] as [DELTAGrantee],[ProfitCommAdj] as [DELTAProfitCommAdj],[PolicyStatus] as [DELTAPolicyStatus],[ParentPolicyId] as [DELTAParentPolicyId],[CancBasis] as [DELTACancBasis],[RemindFreq] as [DELTARemindFreq],[RemindDate] as [DELTARemindDate],[RemindMess] as [DELTARemindMess],[RemindEmail] as [DELTARemindEmail],[TerritoryIdAssured] as [DELTATerritoryIdAssured],[BestCode] as [DELTABestCode],[NAICCode] as [DELTANAICCode],[Producer] as [DELTAProducer],[Class1] as [DELTAClass1],[Class2] as [DELTAClass2],[Class3] as [DELTAClass3],[GeogCode] as [DELTAGeogCode],[TotalSumInsured] as [DELTATotalSumInsured],[CalcFromWritten] as [DELTACalcFromWritten],[BrokerageDeductionsInd] as [DELTABrokerageDeductionsInd],[MaxLimit] as [DELTAMaxLimit],[MinXS] as [DELTAMinXS],[RateFixedInd] as [DELTARateFixedInd],[TopLimitOrigCcyISO] as [DELTATopLimitOrigCcyISO],[TopLimitOrigAmount] as [DELTATopLimitOrigAmount],[TopLimitSettAmount] as [DELTATopLimitSettAmount],[TopLimitConsAmount] as [DELTATopLimitConsAmount],[TopXSOrigAmount] as [DELTATopXSOrigAmount],[TopXSSettAmount] as [DELTATopXSSettAmount],[TopXSConsAmount] as [DELTATopXSConsAmount],[ConsCcyROE] as [DELTAConsCcyROE],[TopLimitSettCcyISO] as [DELTATopLimitSettCcyISO],[FILCode] as [DELTAFILCode],[UserName] as [DELTAUserName],[AggLimit] as [DELTAAggLimit],[PaymentMethod] as [DELTAPaymentMethod],[PaymentType] as [DELTAPaymentType],[AdjFreq] as [DELTAAdjFreq],[AdjPcnt] as [DELTAAdjPcnt],[AdjDsc] as [DELTAAdjDsc],[AdjDate] as [DELTAAdjDate],[DWAgreed] as [DELTADWAgreed],[ClaimFundInd] as [DELTAClaimFundInd],[NeedReCalcInd] as [DELTANeedReCalcInd],[ProfitCommAgreed] as [DELTAProfitCommAgreed],[Class4] as [DELTAClass4],[FrontingInd] as [DELTAFrontingInd],[FinanceUWInd] as [DELTAFinanceUWInd],[NOCInd] as [DELTANOCInd],[FullTermInd] as [DELTAFullTermInd],[EndorsemntInd] as [DELTAEndorsemntInd],[FacReinsInd] as [DELTAFacReinsInd],[MonitorPIMInd] as [DELTAMonitorPIMInd],[DateEntered] as [DELTADateEntered],[UpdBy] as [DELTAUpdBy],[MainLayerInd] as [DELTAMainLayerInd],[QuoteDurationDays] as [DELTAQuoteDurationDays],[UltimateLossRatio] as [DELTAUltimateLossRatio],[AccountsPayable] as [DELTAAccountsPayable],[BenchMarkRating] as [DELTABenchMarkRating],[InstalmentPeriod] as [DELTAInstalmentPeriod],[InitialTOT] as [DELTAInitialTOT],[DeferredTOT] as [DELTADeferredTOT],[FinalTOT] as [DELTAFinalTOT],[ConfidentialNotes] as [DELTAConfidentialNotes],[LOCInd] as [DELTALOCInd],[ReviewDate] as [DELTAReviewDate],[EventName] as [DELTAEventName],[EventMultiple] as [DELTAEventMultiple],[OutdoorEventInd] as [DELTAOutdoorEventInd],[LTPInd] as [DELTALTPInd],[TerrorMiles] as [DELTATerrorMiles],[TerrorDays] as [DELTATerrorDays],[ZipCode] as [DELTAZipCode],[SurveyFees] as [DELTASurveyFees],[VetsFees] as [DELTAVetsFees],[ConsultancyFees] as [DELTAConsultancyFees],[ExpertFees] as [DELTAExpertFees],[AnticipatedLR] as [DELTAAnticipatedLR],[PremWarrantyInd] as [DELTAPremWarrantyInd],[WordingDate] as [DELTAWordingDate],[WordingNote] as [DELTAWordingNote],[NettLineInd] as [DELTANettLineInd],[ReinstBrokerage] as [DELTAReinstBrokerage],[LossWarrantyTriggers] as [DELTALossWarrantyTriggers],[LossReviewPct] as [DELTALossReviewPct],[WarInd] as [DELTAWarInd],[StrikesInd] as [DELTAStrikesInd],[ExpensesInd] as [DELTAExpensesInd],[SurveyInd] as [DELTASurveyInd],[SurveyDate] as [DELTASurveyDate],[NumOfInstalment] as [DELTANumOfInstalment]
,[SettDueDate] as [DELTASettDueDate],[QuoteExpiryDate] as [DELTAQuoteExpiryDate],[QuoteInceptionDate] as [DELTAQuoteInceptionDate],[BureauSettledInd] as [DELTABureauSettledInd],[VenueCity] as [DELTAVenueCity],[LORSCode] as [DELTALORSCode],[NoticeToBrokerInsured] as [DELTANoticeToBrokerInsured],[NoticeToBrokerInsuredDate] as [DELTANoticeToBrokerInsuredDate],[AssuredSignOff] as [DELTAAssuredSignOff],[AssuredSignOffDate] as [DELTAAssuredSignOffDate],[TerrorismAPCcy] as [DELTATerrorismAPCcy],[TerrorismAPAmount] as [DELTATerrorismAPAmount],[TerrorismAPReceived] as [DELTATerrorismAPReceived],[TerrorismAPReceivedDate] as [DELTATerrorismAPReceivedDate],[ZoneA] as [DELTAZoneA],[ZoneB] as [DELTAZoneB],[ZoneC] as [DELTAZoneC],[ZoneD] as [DELTAZoneD],[BusinessInterruption] as [DELTABusinessInterruption],[ManyFacInd] as [DELTAManyFacInd],[EventPeriod] as [DELTAEventPeriod],[EventPeriodInception] as [DELTAEventPeriodInception],[EventPeriodExpiry] as [DELTAEventPeriodExpiry],[PremiumSwitchDate] as [DELTAPremiumSwitchDate],[PremiumSwitchedInd] as [DELTAPremiumSwitchedInd],[RetroDate] as [DELTARetroDate],[MinimumRate] as [DELTAMinimumRate],[MaximumRate] as [DELTAMaximumRate],[LossesLoaded] as [DELTALossesLoaded],[QuotedROL] as [DELTAQuotedROL],[RetroactiveDate] as [DELTARetroactiveDate],[OldStatsRef] as [DELTAOldStatsRef],[Description] as [DELTADescription],[ExternalRef] as [DELTAExternalRef],[OrigPRI] as [DELTAOrigPRI],[OrigCI] as [DELTAOrigCI],[UpdPRI] as [DELTAUpdPRI],[UpdCI] as [DELTAUpdCI],[PRIInd] as [DELTAPRIInd],[ConfiscationInd] as [DELTAConfiscationInd],[OutwardPolicyInd] as [DELTAOutwardPolicyInd],[PeerReviewDate] as [DELTAPeerReviewDate],[PeerReviewInd] as [DELTAPeerReviewInd],[ContractCertainty] as [DELTAContractCertainty],[ContractCertaintyExcpt] as [DELTAContractCertaintyExcpt],[ContractCertaintyDate] as [DELTAContractCertaintyDate],[AggRiskData] as [DELTAAggRiskData],[ExternalRef2] as [DELTAExternalRef2],[BUAAInd] as [DELTABUAAInd],[PRILossRatioOrig] as [DELTAPRILossRatioOrig],[PRILossRatioUpd] as [DELTAPRILossRatioUpd],[PRINewOldPremOrig] as [DELTAPRINewOldPremOrig],[PRINewOldPremUpd] as [DELTAPRINewOldPremUpd],[DeficitClause] as [DELTADeficitClause],[TruePrice] as [DELTATruePrice],[AdditionalLines] as [DELTAAdditionalLines],[AnticipatedLossRatio] as [DELTAAnticipatedLossRatio],[RiskTransfer] as [DELTARiskTransfer],[LeadInd] as [DELTALeadInd],[ManualMatchingInd] as [DELTAManualMatchingInd],[ProcessingType] as [DELTAProcessingType],[Indexed] as [DELTAIndexed],[CommutedDate] as [DELTACommutedDate],[CommutationOptDate] as [DELTACommutationOptDate],[VerificationStatus] as [DELTAVerificationStatus],[CashLossLimit] as [DELTACashLossLimit],[ClaimsAgreement] as [DELTAClaimsAgreement],[TradeCode] as [DELTATradeCode],[Market] as [DELTAMarket],[BrokerSettledInd] as [DELTABrokerSettledInd],[ScheduleTypeId] as [DELTAScheduleTypeId],[DealReference] as [DELTADealReference],[ExternalRef_COMP] as [DELTAExternalRef_COMP],[ExternalRef_ForUniqueConstraint] as [DELTAExternalRef_ForUniqueConstraint],[DecRef_ForUniqueConstraint] as [DELTADecRef_ForUniqueConstraint],[MasterPolicy] as [DELTAMasterPolicy],[ExternallyProvidedInd] as [DELTAExternallyProvidedInd],[PartVIIInd] as [DELTAPartVIIInd],[SYS_CHANGE_OPERATION] as [DELTASYS_CHANGE_OPERATION]
,HASHBYTES('SHA1',CONVERT(NVARCHAR(MAX),CONCAT([ProgramRef]COLLATE Latin1_General_100_BIN2_UTF8,'%',[LayerNum],'%',[StatsCcyROE],'%',[AnnivDate],'%',[DaysNotice],'%',[UW]COLLATE Latin1_General_100_BIN2_UTF8,'%',[Interest]COLLATE Latin1_General_100_BIN2_UTF8,'%',[PolicyId],'%',[PolicyRef]COLLATE Latin1_General_100_BIN2_UTF8,'%',[EntryType]COLLATE Latin1_General_100_BIN2_UTF8,'%',[DecRef]COLLATE Latin1_General_100_BIN2_UTF8,'%',[LloydsBrokerId],'%',[LloydsBrokerRef]COLLATE Latin1_General_100_BIN2_UTF8,'%',[LloydsBrokerContactId],'%',[BucketInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[PeriodType]COLLATE Latin1_General_100_BIN2_UTF8,'%',[InceptionDate],'%',[ExpiryDate],'%',[TermsOfTrade],'%',[DateWritten],'%',[FirstWritten],'%',[ClaimInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[Brokerage],'%',[Deductions],'%',[CancelDate],'%',[StatsCcyISO]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ConsCcyISO]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ConsTotalSyndEPI],'%',[ConsTotalSyndExposure],'%',[Notes]COLLATE Latin1_General_100_BIN2_UTF8,'%',[RenewedFromRef]COLLATE Latin1_General_100_BIN2_UTF8,'%',[RenewedToRef]COLLATE Latin1_General_100_BIN2_UTF8,'%',[GrossPremIncome],'%',[Comm],'%',[CommMisc],'%',[CoverType]COLLATE Latin1_General_100_BIN2_UTF8,'%',[UniqueMarketRef]COLLATE Latin1_General_100_BIN2_UTF8,'%',[PlacingType]COLLATE Latin1_General_100_BIN2_UTF8,'%',[WordingStatus]COLLATE Latin1_General_100_BIN2_UTF8,'%',[PortfolioTransInd],'%',[LossOfUseDaily],'%',[LastUpd],'%',[SectionCode]COLLATE Latin1_General_100_BIN2_UTF8,'%',[Period]COLLATE Latin1_General_100_BIN2_UTF8,'%',[FullTermPeriod]COLLATE Latin1_General_100_BIN2_UTF8,'%',[FullTermInceptionDate],'%',[FullTermExpiryDate],'%',[FullTermResignInd],'%',[ProfitComm],'%',[ProfitComm2],'%',[CommDeductionsInd],'%',[ProfitCommExpense],'%',[OtherDeductions],'%',[PremFreq],'%',[FirstSettDueDate],'%',[SettTermOfTrade],'%',[AdjTermsOfTrade],'%',[CoverMaxPeriod]COLLATE Latin1_General_100_BIN2_UTF8,'%',[CommSlideAt],'%',[BordereauPremTermsOfTrade],'%',[TreatyReinsInd],'%',[CoIns],'%',[SysLastUpd],'%',[NoClaimBonus],'%',[EarnPattern]COLLATE Latin1_General_100_BIN2_UTF8,'%',[LossOfUseLimit],'%',[LossOfUseXs],'%',[LossOfUseExposure],'%',[LossOfUseCcyISO]COLLATE Latin1_General_100_BIN2_UTF8,'%',[LossOfUseXsDsc]COLLATE Latin1_General_100_BIN2_UTF8,'%',[CommSlide],'%',[CommSlideProv],'%',[CommSlideLR],'%',[CommSlideMin],'%',[BordereauClaimTermsOfTrade],'%',[WaitPeriod]COLLATE Latin1_General_100_BIN2_UTF8,'%',[SmokerInd],'%',[BordereauClaimFreq],'%',[Sex]COLLATE Latin1_General_100_BIN2_UTF8,'%',[DateOfBirth],'%',[QuotaSharePct],'%',[BordereauPremFreq],'%',[QuotaShareLine],'%',[ConvertedInd],'%',[IPTPct],'%',[IPTPremApplic],'%',[RepGroup]COLLATE Latin1_General_100_BIN2_UTF8,'%',[SysPolicyType]COLLATE Latin1_General_100_BIN2_UTF8,'%',[TotalSyndEPI],'%',[TotalSyndExposure],'%',[UWDivision]COLLATE Latin1_General_100_BIN2_UTF8,'%',[WriteBackPct],'%',[LloydsBrokerCode]COLLATE Latin1_General_100_BIN2_UTF8,'%',[LloydsBrokerPseud]COLLATE Latin1_General_100_BIN2_UTF8,'%',[YOA],'%',[PerilGroupId],'%',[TerritoryId],'%',[TopLimit],'%',[TopLimitCcyISO]COLLATE Latin1_General_100_BIN2_UTF8,'%',[TopXs]))) as HBTGT100
,HASHBYTES('SHA1',CONVERT(NVARCHAR(MAX),CONCAT([LossOfUseDays],'%',[InsDate],'%',[DelDate],'%',[OtherDeductionsApplyInd],'%',[ProfitCommApplyInd],'%',[PolicyType]COLLATE Latin1_General_100_BIN2_UTF8,'%',[BenefitsType]COLLATE Latin1_General_100_BIN2_UTF8,'%',[NoOfLives],'%',[Grantee]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ProfitCommAdj],'%',[PolicyStatus]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ParentPolicyId],'%',[CancBasis]COLLATE Latin1_General_100_BIN2_UTF8,'%',[RemindFreq]COLLATE Latin1_General_100_BIN2_UTF8,'%',[RemindDate],'%',[RemindMess]COLLATE Latin1_General_100_BIN2_UTF8,'%',[RemindEmail]COLLATE Latin1_General_100_BIN2_UTF8,'%',[TerritoryIdAssured],'%',[BestCode]COLLATE Latin1_General_100_BIN2_UTF8,'%',[NAICCode]COLLATE Latin1_General_100_BIN2_UTF8,'%',[Producer]COLLATE Latin1_General_100_BIN2_UTF8,'%',[Class1]COLLATE Latin1_General_100_BIN2_UTF8,'%',[Class2]COLLATE Latin1_General_100_BIN2_UTF8,'%',[Class3]COLLATE Latin1_General_100_BIN2_UTF8,'%',[GeogCode]COLLATE Latin1_General_100_BIN2_UTF8,'%',[TotalSumInsured],'%',[CalcFromWritten],'%',[BrokerageDeductionsInd],'%',[MaxLimit],'%',[MinXS],'%',[RateFixedInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[TopLimitOrigCcyISO]COLLATE Latin1_General_100_BIN2_UTF8,'%',[TopLimitOrigAmount],'%',[TopLimitSettAmount],'%',[TopLimitConsAmount],'%',[TopXSOrigAmount],'%',[TopXSSettAmount],'%',[TopXSConsAmount],'%',[ConsCcyROE],'%',[TopLimitSettCcyISO]COLLATE Latin1_General_100_BIN2_UTF8,'%',[FILCode]COLLATE Latin1_General_100_BIN2_UTF8,'%',[UserName]COLLATE Latin1_General_100_BIN2_UTF8,'%',[AggLimit],'%',[PaymentMethod]COLLATE Latin1_General_100_BIN2_UTF8,'%',[PaymentType]COLLATE Latin1_General_100_BIN2_UTF8,'%',[AdjFreq]COLLATE Latin1_General_100_BIN2_UTF8,'%',[AdjPcnt],'%',[AdjDsc]COLLATE Latin1_General_100_BIN2_UTF8,'%',[AdjDate],'%',[DWAgreed],'%',[ClaimFundInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[NeedReCalcInd],'%',[ProfitCommAgreed]COLLATE Latin1_General_100_BIN2_UTF8,'%',[Class4]COLLATE Latin1_General_100_BIN2_UTF8,'%',[FrontingInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[FinanceUWInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[NOCInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[FullTermInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[EndorsemntInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[FacReinsInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[MonitorPIMInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[DateEntered],'%',[UpdBy]COLLATE Latin1_General_100_BIN2_UTF8,'%',[MainLayerInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[QuoteDurationDays],'%',[UltimateLossRatio],'%',[AccountsPayable]COLLATE Latin1_General_100_BIN2_UTF8,'%',[BenchMarkRating],'%',[InstalmentPeriod]COLLATE Latin1_General_100_BIN2_UTF8,'%',[InitialTOT],'%',[DeferredTOT],'%',[FinalTOT],'%',[ConfidentialNotes]COLLATE Latin1_General_100_BIN2_UTF8,'%',[LOCInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ReviewDate],'%',[EventName]COLLATE Latin1_General_100_BIN2_UTF8,'%',[EventMultiple],'%',[OutdoorEventInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[LTPInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[TerrorMiles],'%',[TerrorDays],'%',[ZipCode]COLLATE Latin1_General_100_BIN2_UTF8,'%',[SurveyFees],'%',[VetsFees],'%',[ConsultancyFees],'%',[ExpertFees],'%',[AnticipatedLR],'%',[PremWarrantyInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[WordingDate],'%',[WordingNote]COLLATE Latin1_General_100_BIN2_UTF8,'%',[NettLineInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ReinstBrokerage]COLLATE Latin1_General_100_BIN2_UTF8,'%',[LossWarrantyTriggers]COLLATE Latin1_General_100_BIN2_UTF8,'%',[LossReviewPct],'%',[WarInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[StrikesInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ExpensesInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[SurveyInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[SurveyDate],'%',[NumOfInstalment]))) as HBTGT200
,HASHBYTES('SHA1',CONVERT(NVARCHAR(MAX),CONCAT([SettDueDate],'%',[QuoteExpiryDate],'%',[QuoteInceptionDate],'%',[BureauSettledInd],'%',[VenueCity]COLLATE Latin1_General_100_BIN2_UTF8,'%',[LORSCode]COLLATE Latin1_General_100_BIN2_UTF8,'%',[NoticeToBrokerInsured]COLLATE Latin1_General_100_BIN2_UTF8,'%',[NoticeToBrokerInsuredDate],'%',[AssuredSignOff]COLLATE Latin1_General_100_BIN2_UTF8,'%',[AssuredSignOffDate],'%',[TerrorismAPCcy]COLLATE Latin1_General_100_BIN2_UTF8,'%',[TerrorismAPAmount],'%',[TerrorismAPReceived]COLLATE Latin1_General_100_BIN2_UTF8,'%',[TerrorismAPReceivedDate],'%',[ZoneA],'%',[ZoneB],'%',[ZoneC],'%',[ZoneD],'%',[BusinessInterruption],'%',[ManyFacInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[EventPeriod]COLLATE Latin1_General_100_BIN2_UTF8,'%',[EventPeriodInception],'%',[EventPeriodExpiry],'%',[PremiumSwitchDate],'%',[PremiumSwitchedInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[RetroDate],'%',[MinimumRate],'%',[MaximumRate],'%',[LossesLoaded],'%',[QuotedROL],'%',[RetroactiveDate],'%',[OldStatsRef]COLLATE Latin1_General_100_BIN2_UTF8,'%',[Description]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ExternalRef]COLLATE Latin1_General_100_BIN2_UTF8,'%',[OrigPRI],'%',[OrigCI],'%',[UpdPRI],'%',[UpdCI],'%',[PRIInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ConfiscationInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[OutwardPolicyInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[PeerReviewDate],'%',[PeerReviewInd],'%',[ContractCertainty]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ContractCertaintyExcpt]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ContractCertaintyDate],'%',[AggRiskData]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ExternalRef2]COLLATE Latin1_General_100_BIN2_UTF8,'%',[BUAAInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[PRILossRatioOrig],'%',[PRILossRatioUpd],'%',[PRINewOldPremOrig],'%',[PRINewOldPremUpd],'%',[DeficitClause]COLLATE Latin1_General_100_BIN2_UTF8,'%',[TruePrice],'%',[AdditionalLines]COLLATE Latin1_General_100_BIN2_UTF8,'%',[AnticipatedLossRatio],'%',[RiskTransfer]COLLATE Latin1_General_100_BIN2_UTF8,'%',[LeadInd],'%',[ManualMatchingInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ProcessingType]COLLATE Latin1_General_100_BIN2_UTF8,'%',[Indexed]COLLATE Latin1_General_100_BIN2_UTF8,'%',[CommutedDate],'%',[CommutationOptDate],'%',[VerificationStatus]COLLATE Latin1_General_100_BIN2_UTF8,'%',[CashLossLimit],'%',[ClaimsAgreement]COLLATE Latin1_General_100_BIN2_UTF8,'%',[TradeCode]COLLATE Latin1_General_100_BIN2_UTF8,'%',[Market]COLLATE Latin1_General_100_BIN2_UTF8,'%',[BrokerSettledInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ScheduleTypeId],'%',[DealReference]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ExternalRef_COMP]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ExternalRef_ForUniqueConstraint]COLLATE Latin1_General_100_BIN2_UTF8,'%',[DecRef_ForUniqueConstraint]COLLATE Latin1_General_100_BIN2_UTF8,'%',[MasterPolicy]COLLATE Latin1_General_100_BIN2_UTF8,'%',[ExternallyProvidedInd],'%',[PartVIIInd]COLLATE Latin1_General_100_BIN2_UTF8,'%',[SYS_CHANGE_OPERATION]COLLATE Latin1_General_100_BIN2_UTF8))) as HBTGT300
FROM [EclipseBronze].[dbo].[Policy]

--WHERE PolicyId = 683602

 )
 
 SELECT TestResult100,TestResult200,TestResult300, COUNT(*) as TotalRecords
   FROM (

 SELECT Stage.PolicyId as Stage_PolicyId, Delta.DELTAPolicyId as Delta_PolicyId, HBSTG100,HBSTG200,HBSTG300,HBTGT100,HBTGT200,HBTGT300
       ,CASE WHEN HBSTG100 = HBTGT100  then 'Passed' else 'Failed' End as TestResult100
	   ,CASE WHEN HBSTG200 = HBTGT200  then 'Passed' else 'Failed' End as TestResult200
	   ,CASE WHEN HBSTG300 = HBTGT300  then 'Passed' else 'Failed' End as TestResult300
  FROM CTE_Stage Stage 
  Left join CTE_DELTA Delta 
    on Stage.PolicyId = Delta.DELTAPolicyId
	)T GROUP BY TestResult100,TestResult200,TestResult300

--select DISTINCT [BronzeStagingSystemLoadID] from [EclipseBronze].[dbo].[Policy]
--select top 10 * from [EclipseBronze].[dbo].[Policy]